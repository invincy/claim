<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üè¢ LIC Claims Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .dark-bg { 
            background: radial-gradient(ellipse at center, #001122 0%, #000511 50%, #000000 100%);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        .dark-bg::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(0, 255, 255, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(0, 150, 255, 0.02) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(100, 200, 255, 0.02) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: rgba(0, 255, 255, 0.6);
            border-radius: 50%;
            animation: float 6s infinite linear;
            box-shadow: 0 0 6px rgba(0, 255, 255, 0.8);
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) translateX(0px);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) translateX(100px);
                opacity: 0;
            }
        }

        .particle:nth-child(2n) {
            animation-duration: 8s;
            background: rgba(100, 200, 255, 0.4);
            box-shadow: 0 0 4px rgba(100, 200, 255, 0.6);
        }

        .particle:nth-child(3n) {
            animation-duration: 10s;
            background: rgba(0, 150, 255, 0.3);
            box-shadow: 0 0 3px rgba(0, 150, 255, 0.5);
        }
        
        .matte-card { 
            background: rgba(0, 20, 40, 0.15);
            border: 1px solid rgba(0, 255, 255, 0.3);
            backdrop-filter: blur(15px);
            box-shadow: 
                0 0 20px rgba(0, 255, 255, 0.1),
                inset 0 1px 0 rgba(0, 255, 255, 0.2);
            position: relative;
            z-index: 2;
        }
        
        .matte-card::before {
            content: '';
            position: absolute;
            top: -1px;
            left: -1px;
            right: -1px;
            bottom: -1px;
            background: linear-gradient(45deg, 
                rgba(0, 255, 255, 0.4) 0%, 
                rgba(0, 150, 255, 0.2) 25%, 
                rgba(100, 200, 255, 0.1) 50%, 
                rgba(0, 150, 255, 0.2) 75%, 
                rgba(0, 255, 255, 0.4) 100%);
            border-radius: inherit;
            z-index: -1;
            animation: borderGlow 3s ease-in-out infinite alternate;
        }
        
        .matte-form {
            background: rgba(0, 20, 40, 0.2);
            border: 1px solid rgba(0, 255, 255, 0.4);
            backdrop-filter: blur(20px);
            box-shadow: 
                0 0 30px rgba(0, 255, 255, 0.15),
                inset 0 1px 0 rgba(0, 255, 255, 0.3);
            position: relative;
            z-index: 2;
        }
        
        .matte-form::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, 
                rgba(0, 255, 255, 0.6) 0%, 
                rgba(0, 150, 255, 0.3) 25%, 
                rgba(100, 200, 255, 0.2) 50%, 
                rgba(0, 150, 255, 0.3) 75%, 
                rgba(0, 255, 255, 0.6) 100%);
            border-radius: inherit;
            z-index: -1;
            animation: borderGlow 2s ease-in-out infinite alternate;
        }
        
        .glass-header {
            background: rgba(0, 30, 60, 0.2);
            border: 1px solid rgba(0, 255, 255, 0.5);
            backdrop-filter: blur(25px);
            box-shadow: 
                0 0 40px rgba(0, 255, 255, 0.2),
                inset 0 1px 0 rgba(0, 255, 255, 0.4);
            position: relative;
            z-index: 2;
        }
        
        .glass-header::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, 
                rgba(0, 255, 255, 0.8) 0%, 
                rgba(0, 150, 255, 0.4) 25%, 
                rgba(100, 200, 255, 0.3) 50%, 
                rgba(0, 150, 255, 0.4) 75%, 
                rgba(0, 255, 255, 0.8) 100%);
            border-radius: inherit;
            z-index: -1;
            animation: borderGlow 1.5s ease-in-out infinite alternate;
        }

        @keyframes borderGlow {
            0% {
                opacity: 0.5;
                filter: blur(1px);
            }
            100% {
                opacity: 1;
                filter: blur(0px);
            }
        }
        
        .btn-primary {
            background: rgba(0, 150, 255, 0.2);
            color: #00ffff;
            border: 1px solid rgba(0, 255, 255, 0.5);
            transition: all 0.3s ease;
            box-shadow: 
                0 0 15px rgba(0, 255, 255, 0.3),
                inset 0 1px 0 rgba(0, 255, 255, 0.2);
            backdrop-filter: blur(15px);
            position: relative;
            overflow: hidden;
        }
        .btn-primary:hover {
            background: rgba(0, 150, 255, 0.3);
            border-color: rgba(0, 255, 255, 0.8);
            box-shadow: 
                0 0 25px rgba(0, 255, 255, 0.5),
                inset 0 1px 0 rgba(0, 255, 255, 0.4);
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.8);
        }
        
        .btn-danger {
            background: rgba(255, 50, 50, 0.2);
            color: #ff6666;
            border: 1px solid rgba(255, 100, 100, 0.5);
            transition: all 0.3s ease;
            box-shadow: 
                0 0 15px rgba(255, 100, 100, 0.3),
                inset 0 1px 0 rgba(255, 100, 100, 0.2);
            backdrop-filter: blur(15px);
        }
        .btn-danger:hover {
            background: rgba(255, 50, 50, 0.3);
            border-color: rgba(255, 100, 100, 0.8);
            box-shadow: 
                0 0 25px rgba(255, 100, 100, 0.5),
                inset 0 1px 0 rgba(255, 100, 100, 0.4);
            text-shadow: 0 0 10px rgba(255, 100, 100, 0.8);
        }
        
        .btn-success {
            background: rgba(50, 255, 150, 0.2);
            color: #66ff99;
            border: 1px solid rgba(100, 255, 150, 0.5);
            transition: all 0.3s ease;
            box-shadow: 
                0 0 15px rgba(100, 255, 150, 0.3),
                inset 0 1px 0 rgba(100, 255, 150, 0.2);
            backdrop-filter: blur(15px);
        }
        .btn-success:hover {
            background: rgba(50, 255, 150, 0.3);
            border-color: rgba(100, 255, 150, 0.8);
            box-shadow: 
                0 0 25px rgba(100, 255, 150, 0.5),
                inset 0 1px 0 rgba(100, 255, 150, 0.4);
            text-shadow: 0 0 10px rgba(100, 255, 150, 0.8);
        }
        
        .btn-ghost {
            background: rgba(0, 100, 150, 0.1);
            color: #66ccff;
            border: 1px solid rgba(0, 200, 255, 0.3);
            transition: all 0.3s ease;
            backdrop-filter: blur(15px);
            box-shadow: 0 0 10px rgba(0, 200, 255, 0.2);
        }
        .btn-ghost:hover {
            background: rgba(0, 100, 150, 0.2);
            border-color: rgba(0, 255, 255, 0.6);
            color: #00ffff;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.4);
            text-shadow: 0 0 8px rgba(0, 255, 255, 0.6);
        }
        
        .dark-input {
            background: rgba(0, 20, 40, 0.3);
            border: 1px solid rgba(0, 255, 255, 0.4);
            color: #00ffff;
            transition: all 0.3s ease;
            backdrop-filter: blur(15px);
            box-shadow: 
                0 0 10px rgba(0, 255, 255, 0.2),
                inset 0 1px 0 rgba(0, 255, 255, 0.1);
        }
        .dark-input:focus {
            border-color: #00ffff;
            box-shadow: 
                0 0 20px rgba(0, 255, 255, 0.4),
                inset 0 1px 0 rgba(0, 255, 255, 0.3);
            outline: none;
            background: rgba(0, 20, 40, 0.5);
            text-shadow: 0 0 5px rgba(0, 255, 255, 0.5);
        }
        .dark-input::placeholder {
            color: rgba(0, 255, 255, 0.6);
        }
        
        .dark-table {
            background: rgba(0, 20, 40, 0.2);
            border: 1px solid rgba(0, 255, 255, 0.3);
            backdrop-filter: blur(15px);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.1);
        }
        .dark-table-header {
            background: rgba(0, 30, 60, 0.4);
            color: #00ffff;
            border-bottom: 1px solid rgba(0, 255, 255, 0.4);
            text-shadow: 0 0 5px rgba(0, 255, 255, 0.5);
        }
        .dark-table-row:hover {
            background: rgba(0, 100, 150, 0.2);
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.2);
        }
        
        .workflow-section {
            background: rgba(30, 30, 30, 0.9);
            border: 1px solid rgba(75, 85, 99, 0.2);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        .workflow-section:hover {
            border-color: rgba(99, 102, 241, 0.4);
            box-shadow: 0 4px 20px rgba(99, 102, 241, 0.1);
        }
        
        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .collapsible-content.active {
            max-height: 600px;
        }
        .workflow-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .workflow-content.active {
            max-height: 1000px;
        }
        
        .suggestion-early {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #fca5a5;
        }
        .suggestion-medium {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            color: #93c5fd;
        }
        .suggestion-late {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
            color: #86efac;
        }
        
        .checkbox-modern {
            appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(75, 85, 99, 0.5);
            border-radius: 6px;
            background: rgba(17, 24, 39, 0.8);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        .checkbox-modern:checked {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            border-color: #6366f1;
        }
        .checkbox-modern:checked::after {
            content: '‚úì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 12px;
            font-weight: bold;
        }
        
        .radio-modern {
            appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(75, 85, 99, 0.5);
            border-radius: 50%;
            background: rgba(17, 24, 39, 0.8);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        .radio-modern:checked {
            border-color: #6366f1;
        }
        .radio-modern:checked::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            border-radius: 50%;
        }
        
        .option-card {
            background: rgba(30, 30, 30, 0.6);
            border: 1px solid rgba(75, 85, 99, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
            backdrop-filter: blur(10px);
        }
        .option-card:hover {
            border-color: rgba(99, 102, 241, 0.5);
            background: rgba(30, 30, 30, 0.8);
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.1);
        }
        .option-card.selected {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.1);
        }
        
        .counter-badge {
            background: rgba(99, 102, 241, 0.7);
            color: white;
            font-weight: 600;
            border: 1px solid rgba(99, 102, 241, 0.3);
            backdrop-filter: blur(10px);
        }
        
        .section-header {
            background: rgba(17, 24, 39, 0.8);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        .section-header:hover {
            background: rgba(17, 24, 39, 0.9);
        }
        
        .glow-text {
            text-shadow: 
                0 0 10px rgba(0, 255, 255, 0.8),
                0 0 20px rgba(0, 255, 255, 0.6),
                0 0 30px rgba(0, 255, 255, 0.4);
            animation: textGlow 2s ease-in-out infinite alternate;
        }

        @keyframes textGlow {
            0% {
                text-shadow: 
                    0 0 10px rgba(0, 255, 255, 0.8),
                    0 0 20px rgba(0, 255, 255, 0.6),
                    0 0 30px rgba(0, 255, 255, 0.4);
            }
            100% {
                text-shadow: 
                    0 0 15px rgba(0, 255, 255, 1),
                    0 0 25px rgba(0, 255, 255, 0.8),
                    0 0 35px rgba(0, 255, 255, 0.6);
            }
        }
        
        .pulse-glow {
            animation: pulse-glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes pulse-glow {
            from {
                box-shadow: 0 0 20px rgba(99, 102, 241, 0.2);
            }
            to {
                box-shadow: 0 0 30px rgba(99, 102, 241, 0.4);
            }
        }
    </style>
</head>
<body class="dark-bg min-h-screen p-4 md:p-6">
    <!-- Floating Particles -->
    <div class="particles" id="particles"></div>
    
    <div class="max-w-7xl mx-auto relative z-10">
        <!-- Header -->
        <div class="text-center mb-8">
            <div class="glass-header rounded-2xl p-8 mx-auto max-w-3xl pulse-glow">
                <h1 class="text-4xl font-bold text-cyan-300 mb-3 glow-text">üè¢ LIC Claims Hub</h1>
                <p class="text-cyan-200 text-lg">‚ú® Advanced AI-powered claim processing system</p>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="glass-header rounded-2xl p-6 mb-8 mx-auto max-w-2xl">
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <button id="deathClaimBtn" class="btn-danger px-8 py-4 rounded-xl font-semibold text-sm flex items-center justify-center gap-2">
                    üíÄ New Death Claim
                </button>
                <button id="specialCaseBtn" class="btn-primary px-8 py-4 rounded-xl font-semibold text-sm flex items-center justify-center gap-2">
                    ‚ö° New Special Case
                </button>
            </div>
        </div>

        <!-- Special Case Form (Hidden by default) -->
        <div id="specialCaseForm" class="hidden matte-form rounded-3xl p-8 mb-8">
            <h3 class="text-3xl font-bold text-white mb-8 flex items-center gap-3">‚ö° Add Special Case</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div>
                    <label class="block text-sm font-bold text-gray-300 mb-3">üìã Policy Number</label>
                    <input type="text" id="specialPolicyNumber" class="dark-input w-full px-4 py-3 rounded-xl font-medium">
                </div>
                <div>
                    <label class="block text-sm font-bold text-gray-300 mb-3">üë§ Name</label>
                    <input type="text" id="specialName" class="dark-input w-full px-4 py-3 rounded-xl font-medium">
                </div>
                <div>
                    <label class="block text-sm font-bold text-gray-300 mb-3">üè∑Ô∏è Type</label>
                    <select id="specialType" class="dark-input w-full px-4 py-3 rounded-xl font-medium">
                        <option value="">Select Type</option>
                        <option value="M/C">M/C</option>
                        <option value="D/C">D/C</option>
                        <option value="S.B.">S.B.</option>
                        <option value="IPP">IPP</option>
                    </select>
                </div>
            </div>
            
            <div class="mb-6">
                <label class="block text-sm font-bold text-gray-300 mb-3">üìù Issue</label>
                <textarea id="specialIssue" rows="4" class="dark-input w-full px-4 py-3 rounded-xl font-medium" placeholder="Describe the issue..."></textarea>
            </div>

            <div class="mb-8">
                <label class="option-card flex items-center p-4 rounded-xl">
                    <input type="checkbox" id="specialResolved" class="checkbox-modern mr-3">
                    <span class="font-medium text-gray-300">‚úÖ Mark as resolved</span>
                </label>
            </div>

            <div class="flex gap-4">
                <button id="saveSpecialCase" class="btn-success px-6 py-3 rounded-xl font-semibold text-sm">
                    üíæ Save Case
                </button>
                <button id="cancelSpecialForm" class="btn-ghost px-6 py-3 rounded-xl font-semibold text-sm">
                    ‚ùå Cancel
                </button>
            </div>
        </div>

        <!-- Death Claim Form (Hidden by default) -->
        <div id="deathClaimForm" class="hidden matte-form rounded-3xl p-8 mb-8">
            <h3 class="text-3xl font-bold text-white mb-8 flex items-center gap-3">üíÄ Death Claim Form</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div>
                    <label class="block text-sm font-bold text-gray-300 mb-3">üìã Policy Number</label>
                    <input type="text" id="policyNumber" class="dark-input w-full px-4 py-3 rounded-xl font-medium">
                </div>
                <div>
                    <label class="block text-sm font-bold text-gray-300 mb-3">üë§ Name</label>
                    <input type="text" id="claimantName" class="dark-input w-full px-4 py-3 rounded-xl font-medium">
                </div>
                <div>
                    <label class="block text-sm font-bold text-gray-300 mb-3">üìÖ Date of Commencement/ Revival (dd/mm/yyyy)</label>
                    <input type="text" id="commencementDate" placeholder="01/01/2020" maxlength="10" class="dark-input w-full px-4 py-3 rounded-xl font-medium">
                </div>
                <div>
                    <label class="block text-sm font-bold text-gray-300 mb-3">‚ö∞Ô∏è Date of Death (dd/mm/yyyy)</label>
                    <input type="text" id="deathDate" placeholder="15/03/2023" maxlength="10" class="dark-input w-full px-4 py-3 rounded-xl font-medium">
                </div>
            </div>

            <!-- Duration Display -->
            <div id="durationDisplay" class="hidden mb-6 p-6 bg-gradient-to-r from-indigo-900/30 to-purple-900/30 rounded-2xl border border-indigo-500/30 backdrop-blur-sm">
                <span class="font-bold text-gray-300">‚è±Ô∏è Duration: </span>
                <span id="durationText" class="font-bold text-indigo-300 text-xl"></span>
            </div>

            <!-- Suggestion -->
            <div id="suggestionBox" class="hidden mb-6 p-6 rounded-2xl backdrop-blur-sm">
                <span id="suggestionText" class="font-bold text-xl"></span>
            </div>

            <!-- Manual Selection -->
            <div id="manualSelection" class="hidden mb-6">
                <label class="block text-lg font-bold text-gray-300 mb-4">üéØ Select Claim Type:</label>
                <div class="space-y-3">
                    <label class="option-card flex items-center p-4 rounded-xl">
                        <input type="radio" name="claimType" value="Early" class="radio-modern mr-4">
                        <span class="font-semibold text-gray-300">üî¥ Early</span>
                    </label>
                    <label class="option-card flex items-center p-4 rounded-xl">
                        <input type="radio" name="claimType" value="Non-Early (4‚Äì5 Yrs)" class="radio-modern mr-4">
                        <span class="font-semibold text-gray-300">üîµ Non-Early (4‚Äì5 Yrs)</span>
                    </label>
                    <label class="option-card flex items-center p-4 rounded-xl">
                        <input type="radio" name="claimType" value="Non-Early" class="radio-modern mr-4">
                        <span class="font-semibold text-gray-300">üü¢ Non-Early</span>
                    </label>
                </div>
            </div>

            <!-- Workflow Sections -->
            <div id="workflowSections" class="hidden space-y-6 mb-8">
                <!-- Check Nominee Section -->
                <div class="workflow-section rounded-2xl">
                    <button class="workflow-header w-full text-left p-6 font-bold text-white rounded-2xl transition-all duration-300 flex items-center justify-between section-header" data-target="checkNominee">
                        <span class="text-xl flex items-center gap-3">üë• Check Nominee</span>
                        <span class="transform transition-transform text-indigo-400 text-2xl">‚ñº</span>
                    </button>
                    <div id="checkNominee" class="workflow-content">
                        <div class="p-6 pt-0 space-y-4">
                            <label class="option-card flex items-center p-4 rounded-xl">
                                <input type="checkbox" id="nomineeAvailable" class="checkbox-modern mr-4">
                                <span class="font-semibold text-gray-300">‚úÖ Nominee Available</span>
                            </label>
                            <label class="option-card flex items-center p-4 rounded-xl">
                                <input type="checkbox" id="nomineeNotAvailable" class="checkbox-modern mr-4">
                                <span class="font-semibold text-gray-300">‚ùå Nominee Not Available</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Documents Required Section -->
                <div class="workflow-section rounded-2xl">
                    <button class="workflow-header w-full text-left p-6 font-bold text-white rounded-2xl transition-all duration-300 flex items-center justify-between section-header" data-target="documentsRequired">
                        <span class="text-xl flex items-center gap-3">üìÑ Documents Required</span>
                        <span class="transform transition-transform text-indigo-400 text-2xl">‚ñº</span>
                    </button>
                    <div id="documentsRequired" class="workflow-content">
                        <div class="p-6 pt-0 space-y-4">
                            <label class="option-card flex items-center p-4 rounded-xl">
                                <input type="checkbox" id="deathClaimFormDocs" class="checkbox-modern mr-4">
                                <span class="font-semibold text-gray-300">üìã Death Claim Form + Supporting Documents</span>
                            </label>
                            <div id="letFormsSection" class="hidden space-y-6">
                                <label class="option-card flex items-center p-4 rounded-xl">
                                    <input type="checkbox" id="letForms" class="checkbox-modern mr-4">
                                    <span class="font-semibold text-gray-300">‚öñÔ∏è LET Forms (Legal Evidence of Title)</span>
                                </label>
                                
                                <!-- LET Form Requirements Table -->
                                <div class="dark-table rounded-2xl border border-gray-600/30 shadow-2xl overflow-hidden">
                                    <div class="bg-gradient-to-r from-indigo-900/50 to-purple-900/50 px-6 py-4 border-b border-gray-600/30">
                                        <h4 class="font-bold text-white text-lg flex items-center gap-2">üí∞ LET Form Requirements based on NCAP</h4>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="w-full text-sm">
                                            <thead class="dark-table-header">
                                                <tr>
                                                    <th class="px-6 py-4 text-left font-bold text-gray-200 border-b border-gray-600/30">üíµ NCAP Slab</th>
                                                    <th class="px-6 py-4 text-left font-bold text-gray-200 border-b border-gray-600/30">üìù Required Forms</th>
                                                </tr>
                                            </thead>
                                            <tbody class="divide-y divide-gray-600/20">
                                                <tr class="dark-table-row transition-colors">
                                                    <td class="px-6 py-4 font-semibold text-green-300">Up to ‚Çπ5,000</td>
                                                    <td class="px-6 py-4 text-gray-300">Form 3806 (no stamp paper needed)</td>
                                                </tr>
                                                <tr class="dark-table-row transition-colors">
                                                    <td class="px-6 py-4 font-semibold text-blue-300">‚Çπ5,001 to ‚Çπ10,000</td>
                                                    <td class="px-6 py-4 text-gray-300">Form 3806, Form 3805-B (no notarization)</td>
                                                </tr>
                                                <tr class="dark-table-row transition-colors">
                                                    <td class="px-6 py-4 font-semibold text-yellow-300">‚Çπ10,001 to ‚Çπ40,000</td>
                                                    <td class="px-6 py-4 text-gray-300">Form 3806, Form 3805-B (notarized)</td>
                                                </tr>
                                                <tr class="dark-table-row transition-colors">
                                                    <td class="px-6 py-4 font-semibold text-orange-300">‚Çπ40,001 to ‚Çπ1,00,000</td>
                                                    <td class="px-6 py-4 text-gray-300">Form 3806-A (‚Çπ300 stamp), Form 3805-B (‚Çπ300 stamp), notarized</td>
                                                </tr>
                                                <tr class="dark-table-row transition-colors">
                                                    <td class="px-6 py-4 font-semibold text-red-300">Above ‚Çπ1,00,000</td>
                                                    <td class="px-6 py-4 text-gray-300">Form 3806-A (‚Çπ300 stamp), Form 3805 (‚Çπ300 stamp), Form 3807 (surety form), all notarized</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Investigation Section -->
                <div class="workflow-section rounded-2xl">
                    <button class="workflow-header w-full text-left p-6 font-bold text-white rounded-2xl transition-all duration-300 flex items-center justify-between section-header" data-target="investigation">
                        <span class="text-xl flex items-center gap-3">üîç Investigation</span>
                        <span class="transform transition-transform text-indigo-400 text-2xl">‚ñº</span>
                    </button>
                    <div id="investigation" class="workflow-content">
                        <div class="p-6 pt-0 space-y-4">
                            <div class="space-y-3">
                                <label class="option-card flex items-center p-4 rounded-xl">
                                    <input type="radio" name="investigationType" value="ABM(s)" class="radio-modern mr-4">
                                    <span class="font-semibold text-gray-300">üë®‚Äçüíº ABM(s)</span>
                                </label>
                                <label class="option-card flex items-center p-4 rounded-xl">
                                    <input type="radio" name="investigationType" value="Sr. B.M." class="radio-modern mr-4">
                                    <span class="font-semibold text-gray-300">üëî Sr. B.M.</span>
                                </label>
                                <label class="option-card flex items-center p-4 rounded-xl">
                                    <input type="radio" name="investigationType" value="D.O." class="radio-modern mr-4">
                                    <span class="font-semibold text-gray-300">üèõÔ∏è D.O.</span>
                                </label>
                            </div>
                            <div id="investigationDetails" class="hidden space-y-4">
                                <div>
                                    <label class="block text-sm font-bold text-gray-300 mb-3">üìÖ Date Investigation Allotted</label>
                                    <input type="date" id="investigationDate" class="dark-input w-full px-4 py-3 rounded-xl">
                                </div>
                                <div id="daysSinceAllotted" class="text-sm text-gray-300 hidden bg-indigo-900/20 p-4 rounded-xl border border-indigo-500/30">
                                    <span class="font-semibold">‚è∞ Days since allotted: </span><span id="daysCount" class="font-bold text-indigo-300 text-lg"></span>
                                </div>
                                <label class="option-card flex items-center p-4 rounded-xl">
                                    <input type="checkbox" id="investigationReceived" class="checkbox-modern mr-4">
                                    <span class="font-semibold text-gray-300">‚úÖ Investigation Received</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- D.O. Decision Section (Early claims only) -->
                <div id="doDecisionSection" class="workflow-section rounded-2xl hidden">
                    <button class="workflow-header w-full text-left p-6 font-bold text-white rounded-2xl transition-all duration-300 flex items-center justify-between section-header" data-target="doDecision">
                        <span class="text-xl flex items-center gap-3">‚öñÔ∏è D.O. Decision</span>
                        <span class="transform transition-transform text-indigo-400 text-2xl">‚ñº</span>
                    </button>
                    <div id="doDecision" class="workflow-content">
                        <div class="p-6 pt-0 space-y-4">
                            <div>
                                <label class="block text-sm font-bold text-gray-300 mb-3">üì§ Date Sent to D.O.</label>
                                <input type="date" id="doSentDate" class="dark-input w-full px-4 py-3 rounded-xl">
                            </div>
                            <div id="daysSinceSent" class="text-sm text-gray-300 hidden bg-purple-900/20 p-4 rounded-xl border border-purple-500/30">
                                <span class="font-semibold">‚è∞ Days since sent: </span><span id="doSentDaysCount" class="font-bold text-purple-300 text-lg"></span>
                            </div>
                            <label class="option-card flex items-center p-4 rounded-xl">
                                <input type="checkbox" id="doDecisionReceived" class="checkbox-modern mr-4">
                                <span class="font-semibold text-gray-300">‚úÖ D.O. Decision Received</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Proceed for Payment Section -->
                <div class="workflow-section rounded-2xl">
                    <button class="workflow-header w-full text-left p-6 font-bold text-white rounded-2xl transition-all duration-300 flex items-center justify-between section-header" data-target="proceedPayment">
                        <span class="text-xl flex items-center gap-3">üí∞ Proceed for Payment</span>
                        <span class="transform transition-transform text-indigo-400 text-2xl">‚ñº</span>
                    </button>
                    <div id="proceedPayment" class="workflow-content">
                        <div class="p-6 pt-0">
                            <label class="option-card flex items-center p-4 rounded-xl">
                                <input type="checkbox" id="paymentDone" class="checkbox-modern mr-4">
                                <span class="font-semibold text-gray-300">‚úÖ Payment Done</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Query and Save Section -->
                <div class="bg-gradient-to-r from-gray-800/50 to-gray-900/50 rounded-2xl p-6 space-y-4 border border-gray-600/30 backdrop-blur-sm">
                    <div>
                        <label class="block text-lg font-bold text-gray-300 mb-3">üìù Notes</label>
                        <textarea id="queryText" rows="4" class="dark-input w-full px-4 py-3 rounded-xl" placeholder="Enter any queries or notes..."></textarea>
                    </div>
                    <button id="saveProgress" class="btn-success px-6 py-3 rounded-xl font-semibold text-sm">
                        üíæ Save Progress
                    </button>
                </div>
            </div>

            <div class="flex gap-4">
                <button id="cancelForm" class="btn-ghost px-6 py-3 rounded-xl font-semibold text-sm">
                    ‚ùå Cancel
                </button>
            </div>
        </div>

        <!-- Collapsible Sections Container -->
        <div class="glass-header rounded-2xl p-6 mb-8">
            <div class="space-y-6">
                <!-- Active Death Claims -->
                <div class="matte-card rounded-2xl">
                    <button class="collapsible-header w-full text-left p-6 font-medium bg-red-500/20 text-gray-200 hover:bg-red-500/30 rounded-2xl transition-all duration-300 flex items-center justify-between border border-red-500/20 backdrop-blur-sm" data-target="activeDeathClaims">
                        <span class="text-lg flex items-center gap-3">üíÄ Active Death Claims</span>
                        <div class="flex items-center gap-4">
                            <span id="activeDeathClaimsCounter" class="counter-badge px-3 py-1 rounded-full text-sm font-bold">0</span>
                            <span class="transform transition-transform text-gray-300 text-xl">‚ñº</span>
                        </div>
                    </button>
                    <div id="activeDeathClaims" class="collapsible-content">
                        <div class="p-6 pt-0">
                            <div class="dark-table rounded-2xl overflow-hidden shadow-2xl">
                                <table class="w-full">
                                    <thead class="dark-table-header">
                                        <tr>
                                            <th class="px-6 py-4 text-left text-sm font-bold text-gray-200">üìã Policy No</th>
                                            <th class="px-6 py-4 text-left text-sm font-bold text-gray-200">üë§ Name</th>
                                            <th class="px-6 py-4 text-left text-sm font-bold text-gray-200">üè∑Ô∏è Type</th>
                                            <th class="px-6 py-4 text-left text-sm font-bold text-gray-200">üìä Stage</th>
                                            <th class="px-6 py-4 text-left text-sm font-bold text-gray-200">‚ö° Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="activeDeathClaimsTable">
                                        <tr>
                                            <td colspan="5" class="px-6 py-12 text-center text-gray-400 font-medium text-lg">üîç No active death claims</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Active Special Cases -->
                <div class="matte-card rounded-2xl">
                    <button class="collapsible-header w-full text-left p-6 font-medium bg-indigo-500/20 text-gray-200 hover:bg-indigo-500/30 rounded-2xl transition-all duration-300 flex items-center justify-between border border-indigo-500/20 backdrop-blur-sm" data-target="activeSpecialCases">
                        <span class="text-lg flex items-center gap-3">‚ö° Active Special Cases</span>
                        <div class="flex items-center gap-4">
                            <span id="activeSpecialCasesCounter" class="counter-badge px-3 py-1 rounded-full text-sm font-bold">0</span>
                            <span class="transform transition-transform text-gray-300 text-xl">‚ñº</span>
                        </div>
                    </button>
                    <div id="activeSpecialCases" class="collapsible-content">
                        <div class="p-6 pt-0">
                            <div class="dark-table rounded-2xl overflow-hidden shadow-2xl">
                                <table class="w-full">
                                    <thead class="dark-table-header">
                                        <tr>
                                            <th class="px-6 py-4 text-left text-sm font-bold text-gray-200">üìã Policy No</th>
                                            <th class="px-6 py-4 text-left text-sm font-bold text-gray-200">üë§ Name</th>
                                            <th class="px-6 py-4 text-left text-sm font-bold text-gray-200">üè∑Ô∏è Type</th>
                                            <th class="px-6 py-4 text-left text-sm font-bold text-gray-200">üìù Issue</th>
                                            <th class="px-6 py-4 text-left text-sm font-bold text-gray-200">‚ö° Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="activeSpecialCasesTable">
                                        <tr>
                                            <td colspan="5" class="px-6 py-12 text-center text-gray-400 font-medium text-lg">üîç No active special cases</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Completed Death Claims -->
                <div class="matte-card rounded-2xl">
                    <button class="collapsible-header w-full text-left p-6 font-medium bg-green-500/20 text-gray-200 hover:bg-green-500/30 rounded-2xl transition-all duration-300 flex items-center justify-between border border-green-500/20 backdrop-blur-sm" data-target="completedDeathClaims">
                        <span class="text-lg flex items-center gap-3">‚úÖ Completed Death Claims</span>
                        <span class="transform transition-transform text-gray-300 text-xl">‚ñº</span>
                    </button>
                    <div id="completedDeathClaims" class="collapsible-content">
                        <div class="p-6 pt-0">
                            <div class="dark-table rounded-2xl overflow-hidden shadow-2xl">
                                <table class="w-full">
                                    <thead class="dark-table-header">
                                        <tr>
                                            <th class="px-6 py-4 text-left text-sm font-bold text-gray-200">üìã Policy No</th>
                                            <th class="px-6 py-4 text-left text-sm font-bold text-gray-200">üë§ Name</th>
                                            <th class="px-6 py-4 text-left text-sm font-bold text-gray-200">üè∑Ô∏è Type</th>
                                            <th class="px-6 py-4 text-left text-sm font-bold text-gray-200">üìÖ Completed Date</th>
                                            <th class="px-6 py-4 text-left text-sm font-bold text-gray-200">‚ö° Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="completedDeathClaimsTable">
                                        <tr>
                                            <td colspan="5" class="px-6 py-12 text-center text-gray-400 font-medium text-lg">üéâ No completed death claims</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Completed Special Cases -->
                <div class="matte-card rounded-2xl">
                    <button class="collapsible-header w-full text-left p-6 font-medium bg-teal-500/20 text-gray-200 hover:bg-teal-500/30 rounded-2xl transition-all duration-300 flex items-center justify-between border border-teal-500/20 backdrop-blur-sm" data-target="completedSpecialCases">
                        <span class="text-lg flex items-center gap-3">üéØ Completed Special Cases</span>
                        <span class="transform transition-transform text-gray-300 text-xl">‚ñº</span>
                    </button>
                    <div id="completedSpecialCases" class="collapsible-content">
                        <div class="p-6 pt-0">
                            <div class="dark-table rounded-2xl overflow-hidden shadow-2xl">
                                <table class="w-full">
                                    <thead class="dark-table-header">
                                        <tr>
                                            <th class="px-6 py-4 text-left text-sm font-bold text-gray-200">üìã Policy No</th>
                                            <th class="px-6 py-4 text-left text-sm font-bold text-gray-200">üë§ Name</th>
                                            <th class="px-6 py-4 text-left text-sm font-bold text-gray-200">üè∑Ô∏è Type</th>
                                            <th class="px-6 py-4 text-left text-sm font-bold text-gray-200">üìù Issue</th>
                                            <th class="px-6 py-4 text-left text-sm font-bold text-gray-200">‚ö° Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="completedSpecialCasesTable">
                                        <tr>
                                            <td colspan="5" class="px-6 py-12 text-center text-gray-400 font-medium text-lg">üéâ No completed special cases</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Create floating particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 50;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                // Random starting position
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 6 + 's';
                particle.style.animationDuration = (6 + Math.random() * 4) + 's';
                
                // Random size variation
                const size = 1 + Math.random() * 2;
                particle.style.width = size + 'px';
                particle.style.height = size + 'px';
                
                particlesContainer.appendChild(particle);
            }
        }
        
        // Initialize particles when page loads
        document.addEventListener('DOMContentLoaded', function() {
            createParticles();
            loadFromStorage();
            updateCounters();
        });

        // Collapsible functionality
        document.querySelectorAll('.collapsible-header').forEach(header => {
            header.addEventListener('click', function() {
                const target = document.getElementById(this.dataset.target);
                const arrow = this.querySelector('span:last-child');
                
                target.classList.toggle('active');
                arrow.style.transform = target.classList.contains('active') ? 'rotate(180deg)' : 'rotate(0deg)';
            });
        });

        // Workflow collapsible functionality with disabled state check
        document.querySelectorAll('.workflow-header').forEach(header => {
            header.addEventListener('click', function() {
                // Don't allow clicking if section is disabled
                if (this.style.pointerEvents === 'none') {
                    return;
                }
                
                const target = document.getElementById(this.dataset.target);
                const arrow = this.querySelector('span:last-child');
                
                target.classList.toggle('active');
                arrow.style.transform = target.classList.contains('active') ? 'rotate(180deg)' : 'rotate(0deg)';
            });
        });

        // Form functionality
        const deathClaimBtn = document.getElementById('deathClaimBtn');
        const specialCaseBtn = document.getElementById('specialCaseBtn');
        const deathClaimForm = document.getElementById('deathClaimForm');
        const specialCaseForm = document.getElementById('specialCaseForm');
        const cancelForm = document.getElementById('cancelForm');
        const cancelSpecialForm = document.getElementById('cancelSpecialForm');
        deathClaimBtn.addEventListener('click', () => {
            deathClaimForm.classList.remove('hidden');
        });

        specialCaseBtn.addEventListener('click', () => {
            specialCaseForm.classList.remove('hidden');
        });

        cancelForm.addEventListener('click', () => {
            deathClaimForm.classList.add('hidden');
            resetForm();
        });

        cancelSpecialForm.addEventListener('click', () => {
            specialCaseForm.classList.add('hidden');
            resetSpecialForm();
        });

        // Date calculation
        const commencementDate = document.getElementById('commencementDate');
        const deathDate = document.getElementById('deathDate');
        const durationDisplay = document.getElementById('durationDisplay');
        const durationText = document.getElementById('durationText');
        const suggestionBox = document.getElementById('suggestionBox');
        const suggestionText = document.getElementById('suggestionText');
        const manualSelection = document.getElementById('manualSelection');

        // Auto-format date inputs
        function formatDateInput(input) {
            let value = input.value.replace(/\D/g, ''); // Remove non-digits
            if (value.length >= 2) {
                value = value.substring(0, 2) + '/' + value.substring(2);
            }
            if (value.length >= 5) {
                value = value.substring(0, 5) + '/' + value.substring(5, 9);
            }
            input.value = value;
        }

        commencementDate.addEventListener('input', function() {
            formatDateInput(this);
            calculateDuration();
        });

        deathDate.addEventListener('input', function() {
            formatDateInput(this);
            calculateDuration();
        });

        function calculateDuration() {
            const commDate = commencementDate.value.replace(/\//g, '');
            const deathDateVal = deathDate.value.replace(/\//g, '');

            if (commDate.length === 8 && deathDateVal.length === 8) {
                const commYear = parseInt(commDate.substring(4, 8));
                const commMonth = parseInt(commDate.substring(2, 4));
                const commDay = parseInt(commDate.substring(0, 2));

                const deathYear = parseInt(deathDateVal.substring(4, 8));
                const deathMonth = parseInt(deathDateVal.substring(2, 4));
                const deathDay = parseInt(deathDateVal.substring(0, 2));

                const commDateObj = new Date(commYear, commMonth - 1, commDay);
                const deathDateObj = new Date(deathYear, deathMonth - 1, deathDay);

                const diffTime = Math.abs(deathDateObj - commDateObj);
                const diffYears = diffTime / (1000 * 60 * 60 * 24 * 365.25);

                durationText.textContent = `${diffYears.toFixed(2)} years`;
                durationDisplay.classList.remove('hidden');

                // Show suggestion
                let suggestion = '';
                let bgColor = '';
                if (diffYears < 3) {
                    suggestion = 'üü• Suggested: Early Claim';
                    bgColor = 'suggestion-early';
                } else if (diffYears >= 3 && diffYears <= 5) {
                    suggestion = 'üü¶ Suggested: Non-Early (4‚Äì5 Yrs)';
                    bgColor = 'suggestion-medium';
                } else {
                    suggestion = 'üü© Suggested: Non-Early';
                    bgColor = 'suggestion-late';
                }

                suggestionText.textContent = suggestion;
                suggestionBox.className = `p-4 rounded-xl ${bgColor}`;
                suggestionBox.classList.remove('hidden');
                manualSelection.classList.remove('hidden');
            }
        }





        function removeRow(button) {
            const row = button.closest('tr');
            const tableBody = row.parentNode;
            row.remove();
            
            if (tableBody.children.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="5" class="px-4 py-8 text-center text-gray-500">No active death claims</td></tr>';
            }
            saveToStorage();
        }

        // Store case data for reopening with localStorage persistence
        let savedCases = JSON.parse(localStorage.getItem('licSavedCases') || '{}');
        let savedSpecialCases = JSON.parse(localStorage.getItem('licSavedSpecialCases') || '{}');
        let savedWorkflowStates = JSON.parse(localStorage.getItem('licWorkflowStates') || '{}');

        // Save data to localStorage
        function saveToStorage() {
            localStorage.setItem('licSavedCases', JSON.stringify(savedCases));
            localStorage.setItem('licSavedSpecialCases', JSON.stringify(savedSpecialCases));
            localStorage.setItem('licWorkflowStates', JSON.stringify(savedWorkflowStates));
            localStorage.setItem('licActiveClaims', document.getElementById('activeDeathClaimsTable').innerHTML);
            localStorage.setItem('licActiveSpecialCases', document.getElementById('activeSpecialCasesTable').innerHTML);

            updateCounters();
        }

        // Update counters for all sections
        function updateCounters() {
            // Count active death claims
            const activeDeathRows = document.querySelectorAll('#activeDeathClaimsTable tr:not([colspan])');
            const activeDeathCount = activeDeathRows.length > 0 && !activeDeathRows[0].querySelector('td[colspan]') ? activeDeathRows.length : 0;
            document.getElementById('activeDeathClaimsCounter').textContent = activeDeathCount;

            // Count active special cases
            const activeSpecialRows = document.querySelectorAll('#activeSpecialCasesTable tr:not([colspan])');
            const activeSpecialCount = activeSpecialRows.length > 0 && !activeSpecialRows[0].querySelector('td[colspan]') ? activeSpecialRows.length : 0;
            document.getElementById('activeSpecialCasesCounter').textContent = activeSpecialCount;


        }

        // Load data from localStorage
        function loadFromStorage() {
            // Load active death claims
            const activeClaims = localStorage.getItem('licActiveClaims');
            if (activeClaims) {
                document.getElementById('activeDeathClaimsTable').innerHTML = activeClaims;
                // Re-attach event listeners to loaded rows
                document.querySelectorAll('#activeDeathClaimsTable tr').forEach(row => {
                    if (row.querySelector('td:first-child') && !row.querySelector('td[colspan]')) {
                        row.style.cursor = 'pointer';
                        row.onclick = function() { openCase(this); };
                    }
                });
            }

            // Load active special cases
            const activeSpecialCases = localStorage.getItem('licActiveSpecialCases');
            if (activeSpecialCases) {
                document.getElementById('activeSpecialCasesTable').innerHTML = activeSpecialCases;
                // Re-attach event listeners to loaded rows
                document.querySelectorAll('#activeSpecialCasesTable tr').forEach(row => {
                    if (row.querySelector('td:first-child') && !row.querySelector('td[colspan]')) {
                        row.style.cursor = 'pointer';
                        row.onclick = function() { openSpecialCase(this); };
                    }
                });
            }


        }



        // Special Case Save functionality
        document.getElementById('saveSpecialCase').addEventListener('click', function() {
            const policyNo = document.getElementById('specialPolicyNumber').value;
            const name = document.getElementById('specialName').value;
            const type = document.getElementById('specialType').value;
            const issue = document.getElementById('specialIssue').value;
            const resolved = document.getElementById('specialResolved').checked;

            if (!policyNo || !name || !type || !issue) {
                alert('Please fill all fields.');
                return;
            }

            if (resolved) {
                // Add to completed special cases
                const completedTableBody = document.getElementById('completedSpecialCasesTable');
                if (completedTableBody.querySelector('td[colspan="5"]')) {
                    completedTableBody.innerHTML = '';
                }

                const completedRow = document.createElement('tr');
                completedRow.className = 'lic-table-row border-t transition-all duration-300';
                completedRow.innerHTML = `
                    <td class="px-6 py-4 font-semibold text-gray-300">${policyNo}</td>
                    <td class="px-6 py-4 font-semibold text-gray-300">${name}</td>
                    <td class="px-6 py-4 font-semibold text-gray-300">${type}</td>
                    <td class="px-6 py-4 font-semibold text-gray-300">${issue.length > 50 ? issue.substring(0, 50) + '...' : issue}</td>
                    <td class="px-6 py-4">
                        <button class="btn-danger px-4 py-2 rounded-lg text-sm font-bold" onclick="removeCompletedSpecialRow(this)">
                            üóëÔ∏è Remove
                        </button>
                    </td>
                `;
                completedTableBody.appendChild(completedRow);

                // Remove from active cases
                const activeTableBody = document.getElementById('activeSpecialCasesTable');
                const rows = activeTableBody.querySelectorAll('tr');
                rows.forEach(row => {
                    const policyCell = row.querySelector('td:first-child');
                    if (policyCell && policyCell.textContent === policyNo) {
                        row.remove();
                    }
                });

                if (activeTableBody.children.length === 0) {
                    activeTableBody.innerHTML = '<tr><td colspan="5" class="px-4 py-8 text-center text-gray-500">No active special cases</td></tr>';
                }

                saveToStorage();
                alert('Special case marked as resolved and moved to completed cases!');
            } else {
                // Save to active special cases
                const tableBody = document.getElementById('activeSpecialCasesTable');
                if (tableBody.querySelector('td[colspan="5"]')) {
                    tableBody.innerHTML = '';
                }

                // Check if case already exists
                let existingRow = null;
                const rows = tableBody.querySelectorAll('tr');
                rows.forEach(row => {
                    const policyCell = row.querySelector('td:first-child');
                    if (policyCell && policyCell.textContent === policyNo) {
                        existingRow = row;
                    }
                });

                // Save case data for reopening
                savedSpecialCases[policyNo] = {
                    name: name,
                    type: type,
                    issue: issue,
                    resolved: resolved
                };
                saveToStorage();

                if (existingRow) {
                    // Update existing row
                    existingRow.innerHTML = `
                        <td class="px-6 py-4 font-semibold text-gray-300">${policyNo}</td>
                        <td class="px-6 py-4 font-semibold text-gray-300">${name}</td>
                        <td class="px-6 py-4 font-semibold text-gray-300">${type}</td>
                        <td class="px-6 py-4 font-semibold text-gray-300">${issue.length > 50 ? issue.substring(0, 50) + '...' : issue}</td>
                        <td class="px-6 py-4">
                            <button class="btn-danger px-4 py-2 rounded-lg text-sm font-bold" onclick="event.stopPropagation(); removeSpecialRow(this)">
                                üóëÔ∏è Remove
                            </button>
                        </td>
                    `;
                    existingRow.className = 'lic-table-row border-t transition-all duration-300';
                    existingRow.style.cursor = 'pointer';
                    existingRow.onclick = function() { openSpecialCase(this); };
                } else {
                    // Add new row
                    const row = document.createElement('tr');
                    row.className = 'lic-table-row border-t transition-all duration-300';
                    row.style.cursor = 'pointer';
                    row.innerHTML = `
                        <td class="px-6 py-4 font-semibold text-gray-300">${policyNo}</td>
                        <td class="px-6 py-4 font-semibold text-gray-300">${name}</td>
                        <td class="px-6 py-4 font-semibold text-gray-300">${type}</td>
                        <td class="px-6 py-4 font-semibold text-gray-300">${issue.length > 50 ? issue.substring(0, 50) + '...' : issue}</td>
                        <td class="px-6 py-4">
                            <button class="btn-danger px-4 py-2 rounded-lg text-sm font-bold" onclick="event.stopPropagation(); removeSpecialRow(this)">
                                üóëÔ∏è Remove
                            </button>
                        </td>
                    `;
                    row.onclick = function() { openSpecialCase(this); };
                    tableBody.appendChild(row);
                }

                alert('Special case saved successfully!');
            }

            specialCaseForm.classList.add('hidden');
            resetSpecialForm();
        });

        function openCase(row) {
            const cells = row.querySelectorAll('td');
            
            // Extract data from the row
            const policyNo = cells[0].textContent;
            const name = cells[1].textContent;
            const claimType = cells[2].textContent;
            const stage = cells[3].textContent;
            
            // Show the form
            deathClaimForm.classList.remove('hidden');
            
            // Populate basic fields
            document.getElementById('policyNumber').value = policyNo;
            document.getElementById('claimantName').value = name;
            
            // Restore all saved data if exists
            if (savedCases[policyNo]) {
                const savedData = savedCases[policyNo];
                
                // Restore basic form data
                if (savedData.commencementDate) document.getElementById('commencementDate').value = savedData.commencementDate;
                if (savedData.deathDate) document.getElementById('deathDate').value = savedData.deathDate;
                if (savedData.query) document.getElementById('queryText').value = savedData.query;
                
                // Trigger duration calculation if dates exist
                if (savedData.commencementDate && savedData.deathDate) {
                    calculateDuration();
                }
            }
            
            // Select the claim type
            const claimTypeRadio = document.querySelector(`input[name="claimType"][value="${claimType}"]`);
            if (claimTypeRadio) {
                claimTypeRadio.checked = true;
                claimTypeRadio.dispatchEvent(new Event('change'));
            }
            
            // Show workflow sections
            document.getElementById('workflowSections').classList.remove('hidden');
            
            // Restore workflow state if exists
            if (savedWorkflowStates[policyNo]) {
                const workflowState = savedWorkflowStates[policyNo];
                
                // Restore all form inputs
                Object.keys(workflowState).forEach(inputId => {
                    const input = document.getElementById(inputId);
                    if (input) {
                        if (input.type === 'checkbox' || input.type === 'radio') {
                            input.checked = workflowState[inputId];
                            if (input.checked) {
                                input.dispatchEvent(new Event('change'));
                            }
                        } else {
                            input.value = workflowState[inputId];
                            if (input.type === 'date' && input.value) {
                                input.dispatchEvent(new Event('change'));
                            }
                        }
                    }
                });
            }
            
            alert(`üìÇ Opening case: ${policyNo} - ${name}`);
        }

        function removeSpecialRow(button) {
            const row = button.closest('tr');
            const tableBody = row.parentNode;
            row.remove();
            
            if (tableBody.children.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="5" class="px-4 py-8 text-center text-gray-500">No active special cases</td></tr>';
            }
            saveToStorage();
        }

        function openSpecialCase(row) {
            const cells = row.querySelectorAll('td');
            
            // Extract data from the row
            const policyNo = cells[0].textContent;
            const name = cells[1].textContent;
            const type = cells[2].textContent;
            const issue = cells[3].textContent;
            
            // Show the form
            specialCaseForm.classList.remove('hidden');
            
            // Populate fields
            document.getElementById('specialPolicyNumber').value = policyNo;
            document.getElementById('specialName').value = name;
            document.getElementById('specialType').value = type;
            
            // Restore full issue text and resolved status from saved data
            if (savedSpecialCases[policyNo]) {
                document.getElementById('specialIssue').value = savedSpecialCases[policyNo].issue;
                document.getElementById('specialResolved').checked = savedSpecialCases[policyNo].resolved;
            } else {
                document.getElementById('specialIssue').value = issue;
                document.getElementById('specialResolved').checked = false;
            }
            
            alert(`Opening special case: ${policyNo} - ${name}`);
        }

        function resetSpecialForm() {
            document.getElementById('specialPolicyNumber').value = '';
            document.getElementById('specialName').value = '';
            document.getElementById('specialType').value = '';
            document.getElementById('specialIssue').value = '';
            document.getElementById('specialResolved').checked = false;
        }

        // Workflow logic
        const nomineeAvailable = document.getElementById('nomineeAvailable');
        const nomineeNotAvailable = document.getElementById('nomineeNotAvailable');
        const letFormsLabel = document.getElementById('letFormsLabel');
        const investigationRadios = document.querySelectorAll('input[name="investigationType"]');
        const investigationDetails = document.getElementById('investigationDetails');
        const investigationDate = document.getElementById('investigationDate');
        const daysSinceAllotted = document.getElementById('daysSinceAllotted');
        const daysCount = document.getElementById('daysCount');
        const doSentDate = document.getElementById('doSentDate');
        const daysSinceSent = document.getElementById('daysSinceSent');
        const doSentDaysCount = document.getElementById('doSentDaysCount');
        const doDecisionSection = document.getElementById('doDecisionSection');
        const paymentDone = document.getElementById('paymentDone');

        // Nominee checkbox logic (mutually exclusive) with completion tracking
        nomineeAvailable.addEventListener('change', function() {
            if (this.checked) {
                nomineeNotAvailable.checked = false;
                document.getElementById('letFormsSection').classList.add('hidden');
            }
            checkSectionCompletion('checkNominee');
        });

        nomineeNotAvailable.addEventListener('change', function() {
            if (this.checked) {
                nomineeAvailable.checked = false;
                document.getElementById('letFormsSection').classList.remove('hidden');
            } else {
                document.getElementById('letFormsSection').classList.add('hidden');
            }
            checkSectionCompletion('checkNominee');
        });

        // Documents completion tracking
        document.getElementById('deathClaimFormDocs').addEventListener('change', function() {
            checkSectionCompletion('documentsRequired');
        });

        document.getElementById('letForms').addEventListener('change', function() {
            checkSectionCompletion('documentsRequired');
        });

        // Investigation radio logic with completion tracking
        investigationRadios.forEach(radio => {
            radio.addEventListener('change', function() {
                if (this.checked) {
                    investigationDetails.classList.remove('hidden');
                }
                checkSectionCompletion('investigation');
            });
        });

        // Investigation received completion tracking
        document.getElementById('investigationReceived').addEventListener('change', function() {
            checkSectionCompletion('investigation');
        });

        // D.O. Decision completion tracking
        document.getElementById('doDecisionReceived').addEventListener('change', function() {
            checkSectionCompletion('doDecision');
        });

        // Investigation date calculation
        investigationDate.addEventListener('change', function() {
            if (this.value) {
                const allottedDate = new Date(this.value);
                const today = new Date();
                const diffTime = Math.abs(today - allottedDate);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                daysCount.textContent = diffDays;
                daysSinceAllotted.classList.remove('hidden');
            }
        });

        // D.O. sent date calculation
        doSentDate.addEventListener('change', function() {
            if (this.value) {
                const sentDate = new Date(this.value);
                const today = new Date();
                const diffTime = Math.abs(today - sentDate);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                doSentDaysCount.textContent = diffDays;
                daysSinceSent.classList.remove('hidden');
            }
        });

        // Progressive workflow logic based on claim type
        document.querySelectorAll('input[name="claimType"]').forEach(radio => {
            radio.addEventListener('change', function() {
                // Show workflow sections when claim type is selected
                document.getElementById('workflowSections').classList.remove('hidden');
                
                // Reset all sections to collapsed and disabled
                resetWorkflowSections();
                
                // Enable first section (Check Nominee)
                enableSection('checkNominee');
                
                // Store selected claim type for workflow control
                window.selectedClaimType = this.value;
                
                // Show/hide sections based on claim type
                const investigationSection = document.getElementById('investigation').parentElement;
                if (this.value === 'Early') {
                    doDecisionSection.classList.remove('hidden');
                    investigationSection.classList.remove('hidden');
                } else if (this.value === 'Non-Early (4‚Äì5 Yrs)') {
                    doDecisionSection.classList.add('hidden');
                    investigationSection.classList.remove('hidden');
                } else { // Non-Early (>5 years)
                    doDecisionSection.classList.add('hidden');
                    investigationSection.classList.add('hidden');
                }
            });
        });

        function resetWorkflowSections() {
            // Collapse all workflow sections
            document.querySelectorAll('.workflow-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Reset all arrows
            document.querySelectorAll('.workflow-header span:last-child').forEach(arrow => {
                arrow.style.transform = 'rotate(0deg)';
            });
            
            // Disable all sections except the first one
            const sections = ['checkNominee', 'documentsRequired', 'investigation', 'doDecision', 'proceedPayment'];
            sections.forEach(sectionId => {
                disableSection(sectionId);
            });
        }

        function enableSection(sectionId) {
            const section = document.getElementById(sectionId);
            const header = document.querySelector(`[data-target="${sectionId}"]`);
            
            if (section && header) {
                header.classList.remove('opacity-50', 'cursor-not-allowed');
                header.classList.add('hover:bg-gray-50');
                header.style.pointerEvents = 'auto';
            }
        }

        function disableSection(sectionId) {
            const section = document.getElementById(sectionId);
            const header = document.querySelector(`[data-target="${sectionId}"]`);
            
            if (section && header) {
                header.classList.add('opacity-50', 'cursor-not-allowed');
                header.classList.remove('hover:bg-gray-50');
                header.style.pointerEvents = 'none';
                section.classList.remove('active');
            }
        }

        function checkSectionCompletion(sectionId) {
            let isComplete = false;
            let nextSectionId = null;
            
            switch(sectionId) {
                case 'checkNominee':
                    isComplete = nomineeAvailable.checked || nomineeNotAvailable.checked;
                    if (isComplete) {
                        nextSectionId = 'documentsRequired';
                        enableSection('documentsRequired');
                    }
                    break;
                    
                case 'documentsRequired':
                    const deathClaimFormChecked = document.getElementById('deathClaimFormDocs').checked;
                    const letFormsChecked = document.getElementById('letForms').checked;
                    const letFormsRequired = !document.getElementById('letFormsSection').classList.contains('hidden');
                    
                    isComplete = deathClaimFormChecked && (!letFormsRequired || letFormsChecked);
                    if (isComplete) {
                        if (window.selectedClaimType === 'Non-Early') {
                            // For Non-Early (>5 years), skip investigation and go to payment
                            nextSectionId = 'proceedPayment';
                            enableSection('proceedPayment');
                        } else {
                            nextSectionId = 'investigation';
                            enableSection('investigation');
                        }
                    }
                    break;
                    
                case 'investigation':
                    const investigationTypeSelected = document.querySelector('input[name="investigationType"]:checked');
                    const investigationReceived = document.getElementById('investigationReceived').checked;
                    
                    isComplete = investigationTypeSelected && investigationReceived;
                    if (isComplete) {
                        if (window.selectedClaimType === 'Early') {
                            nextSectionId = 'doDecision';
                            enableSection('doDecision');
                        } else {
                            nextSectionId = 'proceedPayment';
                            enableSection('proceedPayment');
                        }
                    }
                    break;
                    
                case 'doDecision':
                    const doDecisionReceived = document.getElementById('doDecisionReceived').checked;
                    isComplete = doDecisionReceived;
                    if (isComplete) {
                        nextSectionId = 'proceedPayment';
                        enableSection('proceedPayment');
                    }
                    break;
            }
            
            // Auto-expand next section when current section is completed
            if (isComplete && nextSectionId) {
                setTimeout(() => {
                    autoExpandSection(nextSectionId);
                }, 300); // Small delay for smooth transition
            }
            
            return isComplete;
        }

        function autoExpandSection(sectionId) {
            const section = document.getElementById(sectionId);
            const header = document.querySelector(`[data-target="${sectionId}"]`);
            const arrow = header.querySelector('span:last-child');
            
            if (section && header && !section.classList.contains('active')) {
                section.classList.add('active');
                arrow.style.transform = 'rotate(180deg)';
            }
        }

        // Payment done - move to completed claims
        paymentDone.addEventListener('change', function() {
            if (this.checked) {
                const policyNo = document.getElementById('policyNumber').value;
                const name = document.getElementById('claimantName').value;
                const selectedType = document.querySelector('input[name="claimType"]:checked');
                
                if (policyNo && name && selectedType) {
                    // Add to completed claims
                    const completedTableBody = document.getElementById('completedDeathClaimsTable');
                    if (completedTableBody.querySelector('td[colspan="5"]')) {
                        completedTableBody.innerHTML = '';
                    }

                    const completedRow = document.createElement('tr');
                    completedRow.className = 'lic-table-row border-t transition-all duration-300';
                    completedRow.innerHTML = `
                        <td class="px-6 py-4 font-semibold text-gray-300">${policyNo}</td>
                        <td class="px-6 py-4 font-semibold text-gray-300">${name}</td>
                        <td class="px-6 py-4 font-semibold text-gray-300">${selectedType.value}</td>
                        <td class="px-6 py-4 font-semibold text-gray-300">${new Date().toLocaleDateString()}</td>
                        <td class="px-6 py-4">
                            <button class="btn-danger px-4 py-2 rounded-lg text-sm font-bold" onclick="removeCompletedRow(this)">
                                üóëÔ∏è Remove
                            </button>
                        </td>
                    `;
                    completedTableBody.appendChild(completedRow);

                    // Remove from active claims
                    const activeTableBody = document.getElementById('activeDeathClaimsTable');
                    const rows = activeTableBody.querySelectorAll('tr');
                    rows.forEach(row => {
                        const policyCell = row.querySelector('td:first-child');
                        if (policyCell && policyCell.textContent === policyNo) {
                            row.remove();
                        }
                    });

                    if (activeTableBody.children.length === 0) {
                        activeTableBody.innerHTML = '<tr><td colspan="5" class="px-4 py-8 text-center text-gray-500">No active death claims</td></tr>';
                    }

                    saveToStorage();
                    alert('Claim completed and moved to completed claims!');
                    deathClaimForm.classList.add('hidden');
                    resetForm();
                }
            }
        });

        // Save progress functionality
        document.getElementById('saveProgress').addEventListener('click', function() {
            const policyNo = document.getElementById('policyNumber').value;
            const name = document.getElementById('claimantName').value;
            const selectedType = document.querySelector('input[name="claimType"]:checked');

            if (!policyNo || !name || !selectedType) {
                alert('‚ö†Ô∏è Please fill basic claim information first.');
                return;
            }

            // Save all form data
            const formData = {
                commencementDate: document.getElementById('commencementDate').value,
                deathDate: document.getElementById('deathDate').value,
                query: document.getElementById('queryText').value
            };
            savedCases[policyNo] = formData;

            // Save workflow state
            const workflowState = {};
            const allInputs = document.querySelectorAll('#workflowSections input, #workflowSections select, #workflowSections textarea');
            allInputs.forEach(input => {
                if (input.type === 'checkbox' || input.type === 'radio') {
                    workflowState[input.id] = input.checked;
                } else {
                    workflowState[input.id] = input.value;
                }
            });
            savedWorkflowStates[policyNo] = workflowState;

            // Update or add to active claims table
            const tableBody = document.getElementById('activeDeathClaimsTable');
            if (tableBody.querySelector('td[colspan="5"]')) {
                tableBody.innerHTML = '';
            }

            // Check if claim already exists
            let existingRow = null;
            const rows = tableBody.querySelectorAll('tr');
            rows.forEach(row => {
                const policyCell = row.querySelector('td:first-child');
                if (policyCell && policyCell.textContent === policyNo) {
                    existingRow = row;
                }
            });

            const stage = getClaimStage();
            
            saveToStorage();

            if (existingRow) {
                // Update existing row
                existingRow.innerHTML = `
                    <td class="px-6 py-4 font-semibold text-gray-300">${policyNo}</td>
                    <td class="px-6 py-4 font-semibold text-gray-300">${name}</td>
                    <td class="px-6 py-4 font-semibold text-gray-300">${selectedType.value}</td>
                    <td class="px-6 py-4 font-semibold text-gray-300">${stage}</td>
                    <td class="px-6 py-4">
                        <button class="btn-danger px-4 py-2 rounded-lg text-sm font-bold" onclick="event.stopPropagation(); removeRow(this)">
                            üóëÔ∏è Remove
                        </button>
                    </td>
                `;
                existingRow.className = 'dark-table-row border-t transition-all duration-300';
                existingRow.style.cursor = 'pointer';
                existingRow.onclick = function() { openCase(this); };
            } else {
                // Add new row
                const row = document.createElement('tr');
                row.className = 'dark-table-row border-t transition-all duration-300';
                row.style.cursor = 'pointer';
                row.innerHTML = `
                    <td class="px-6 py-4 font-semibold text-gray-300">${policyNo}</td>
                    <td class="px-6 py-4 font-semibold text-gray-300">${name}</td>
                    <td class="px-6 py-4 font-semibold text-gray-300">${selectedType.value}</td>
                    <td class="px-6 py-4 font-semibold text-gray-300">${stage}</td>
                    <td class="px-6 py-4">
                        <button class="btn-danger px-4 py-2 rounded-lg text-sm font-bold" onclick="event.stopPropagation(); removeRow(this)">
                            üóëÔ∏è Remove
                        </button>
                    </td>
                `;
                row.onclick = function() { openCase(this); };
                tableBody.appendChild(row);
            }

            alert('üíæ Progress saved successfully!');
            deathClaimForm.classList.add('hidden');
            resetForm();
        });

        function getClaimStage() {
            if (document.getElementById('paymentDone').checked) return 'Payment Done';
            if (document.getElementById('doDecisionReceived') && document.getElementById('doDecisionReceived').checked) return 'D.O. Decision Received';
            if (document.getElementById('investigationReceived').checked) return 'Investigation Complete';
            if (document.getElementById('investigationDate').value) return 'Under Investigation';
            if (document.getElementById('deathClaimFormDocs').checked) return 'Documents Received';
            if (document.getElementById('nomineeAvailable').checked || document.getElementById('nomineeNotAvailable').checked) return 'Nominee Verified';
            return 'Initial Review';
        }

        function removeCompletedRow(button) {
            const row = button.closest('tr');
            const tableBody = row.parentNode;
            row.remove();
            
            if (tableBody.children.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="5" class="px-4 py-8 text-center text-gray-500">No completed death claims</td></tr>';
            }
            saveToStorage();
        }

        function removeCompletedSpecialRow(button) {
            const row = button.closest('tr');
            const tableBody = row.parentNode;
            row.remove();
            
            if (tableBody.children.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="5" class="px-4 py-8 text-center text-gray-500">No completed special cases</td></tr>';
            }
            saveToStorage();
        }

        function resetForm() {
            document.getElementById('policyNumber').value = '';
            document.getElementById('claimantName').value = '';
            document.getElementById('commencementDate').value = '';
            document.getElementById('deathDate').value = '';
            durationDisplay.classList.add('hidden');
            suggestionBox.classList.add('hidden');
            manualSelection.classList.add('hidden');
            document.getElementById('workflowSections').classList.add('hidden');
            document.querySelectorAll('input[name="claimType"]').forEach(radio => radio.checked = false);
            
            // Reset all workflow inputs
            document.querySelectorAll('#workflowSections input').forEach(input => {
                if (input.type === 'checkbox' || input.type === 'radio') {
                    input.checked = false;
                } else {
                    input.value = '';
                }
            });
            document.getElementById('queryText').value = '';
            document.getElementById('letFormsSection').classList.add('hidden');
            investigationDetails.classList.add('hidden');
            daysSinceAllotted.classList.add('hidden');
            daysSinceSent.classList.add('hidden');
            doDecisionSection.classList.add('hidden');
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96fbbb47543f45ed',t:'MTc1NTI5Mjc4MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
